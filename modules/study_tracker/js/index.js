!function(modules){function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:!1};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.loaded=!0,module.exports}var installedModules={};return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.p="",__webpack_require__(0)}({0:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _StudyTracker=__webpack_require__(25),_StudyTracker2=_interopRequireDefault(_StudyTracker);window.onload=function(){ReactDOM.render(React.createElement(_StudyTracker2.default,null),document.getElementById("page"))}},25:function(module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function prettyStatus(status,dueDate){var html=void 0,toReturn=void 0;if(toReturn={status:"",html:"",daysLeft:null},!status)return toReturn;if(~status.indexOf("complete"))html=React.createElement("span",{className:"complete right-align"},"complete"),toReturn={status:"complete",html:html};else if(~status.indexOf("deadline-approaching")){var daysLeft=Math.ceil((new Date(dueDate)-new Date)*MS_TO_DAYS),strDaysLeft=daysLeft+"";strDaysLeft+=1==daysLeft?" day":" days",html=React.createElement("span",{className:"deadline-approaching right-align"},"due in ",strDaysLeft),toReturn={status:"deadline-approaching",html:html,daysLeft:daysLeft}}else if(~status.indexOf("deadline-past")){var daysPast=Math.ceil((new Date-new Date(dueDate))*MS_TO_DAYS),strDaysPast=daysPast+"";strDaysPast+=1==daysPast?" day":" days",html=React.createElement("span",{className:"deadline-past right-align"},strDaysPast," late"),toReturn={status:"deadline-past",html:html,daysLeft:-daysPast}}else~status.indexOf("cancelled")?(html=React.createElement("span",{className:"cancelled right-align"},"visit cancelled"),toReturn={status:"cancelled",html:html}):~status.indexOf("no-deadline")&&(html=React.createElement("span",{className:"no-deadline right-align"},"no deadline specified"),toReturn={status:"no-deadline",html:html});return toReturn}function formatDate(date){var monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"],day=date.getDate(),monthIndex=date.getMonth(),year=date.getFullYear();return monthNames[monthIndex]+" "+day+", "+year}function openBVLFeedback(candID,sessionID,commentID,testName){var url=loris.BaseURL+"/";if(candID&&sessionID&&commentID&&testName)url+=testName+"/?commentID="+commentID+"&sessionID="+sessionID+"&candID="+candID;else if(candID&&sessionID)url+="instrument_list/?candID="+candID+"&sessionID="+sessionID;else{if(!candID)return;url+=candID}var win=window.open(url,"_blank");win.onload=function(){win.document.querySelector("a.navbar-toggle").dispatchEvent(new MouseEvent("click"))}}function openConflictResolver(candID,testName,e){loris.loadFilteredMenuClickHandler("conflict_resolver/",{CandID:candID,Instrument:testName})(e)}Object.defineProperty(exports,"__esModule",{value:!0});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),MS_TO_DAYS=1/864e5,SIDEBAR_WIDTH="24%",COMPRESS_TBL_WIDTH="75%",HIGHLIGHT_COLOR="#E9EBF3",GET_DATA_URL=loris.BaseURL+"/study_tracker/ajax/getData.php",backToFrontVLs=new Map,frontToBackVLs=new Map,SiteFilter=function(_React$Component){function SiteFilter(props){return _classCallCheck(this,SiteFilter),_possibleConstructorReturn(this,(SiteFilter.__proto__||Object.getPrototypeOf(SiteFilter)).call(this,props))}return _inherits(SiteFilter,_React$Component),_createClass(SiteFilter,[{key:"render",value:function(){var options=[],sites=this.props.sites;console.log(sites),Object.keys(sites).length>1&&options.push(React.createElement("option",{key:"all",value:"all"},"Show All Sites"));var centerID=void 0;for(centerID in sites)options.push(React.createElement("option",{key:centerID,value:centerID},sites[centerID]));return React.createElement("select",{className:"form-control input-sm",onChange:this.props.filterSites},options)}}]),SiteFilter}(React.Component),CandidateFilter=function(_React$Component2){function CandidateFilter(props){_classCallCheck(this,CandidateFilter);var _this2=_possibleConstructorReturn(this,(CandidateFilter.__proto__||Object.getPrototypeOf(CandidateFilter)).call(this,props));return _this2.handleTextInputChange=_this2.handleTextInputChange.bind(_this2),_this2}return _inherits(CandidateFilter,_React$Component2),_createClass(CandidateFilter,[{key:"handleTextInputChange",value:function(e){this.props.filterCand(e.target.value)}},{key:"render",value:function(){return React.createElement("input",{className:"form-control input-sm",type:"text",name:"filterCand",value:this.props.filterCandText,onChange:this.handleTextInputChange,placeholder:"Search by PSCID"})}}]),CandidateFilter}(React.Component),CohortFilter=function(_React$Component3){function CohortFilter(props){return _classCallCheck(this,CohortFilter),_possibleConstructorReturn(this,(CohortFilter.__proto__||Object.getPrototypeOf(CohortFilter)).call(this,props))}return _inherits(CohortFilter,_React$Component3),_createClass(CohortFilter,[{key:"render",value:function(){var options=[],cohorts=this.props.cohorts,cohortID=void 0;for(cohortID in cohorts)options.push(React.createElement("option",{key:cohortID,value:cohortID},cohorts[cohortID]));return React.createElement("select",{className:"form-control input-sm",onChange:this.props.filterCohorts},React.createElement("option",{value:"all"},"Show All Cohorts"),options)}}]),CohortFilter}(React.Component),FilterDisplayToggle=function(_React$Component4){function FilterDisplayToggle(){return _classCallCheck(this,FilterDisplayToggle),_possibleConstructorReturn(this,(FilterDisplayToggle.__proto__||Object.getPrototypeOf(FilterDisplayToggle)).apply(this,arguments))}return _inherits(FilterDisplayToggle,_React$Component4),_createClass(FilterDisplayToggle,[{key:"render",value:function(){var glyphClass="down";return this.props.filtersOpen&&(glyphClass="up"),React.createElement("h5",{className:"right-align",onClick:this.props.showFilters},"Filters Â ",React.createElement("span",{className:"glyphicon glyphicon-chevron-"+glyphClass}))}}]),FilterDisplayToggle}(React.Component),Filters=function(_React$Component5){function Filters(){return _classCallCheck(this,Filters),_possibleConstructorReturn(this,(Filters.__proto__||Object.getPrototypeOf(Filters)).apply(this,arguments))}return _inherits(Filters,_React$Component5),_createClass(Filters,[{key:"render",value:function(){return React.createElement("div",{className:"Filters col-md-6"},React.createElement("div",{className:"col-md-4"},React.createElement(CandidateFilter,{filterCand:this.props.filterCand})),React.createElement("div",{className:"col-md-4"},React.createElement(SiteFilter,{sites:this.props.sites,filterSites:this.props.filterSites})),React.createElement("div",{className:"col-md-4"},React.createElement(CohortFilter,{cohorts:this.props.cohorts,filterCohorts:this.props.filterCohorts})))}}]),Filters}(React.Component),Legend=function(_React$Component6){function Legend(){return _classCallCheck(this,Legend),_possibleConstructorReturn(this,(Legend.__proto__||Object.getPrototypeOf(Legend)).apply(this,arguments))}return _inherits(Legend,_React$Component6),_createClass(Legend,[{key:"render",value:function(){return React.createElement("div",null,React.createElement("div",{className:"SideBarHeader"},React.createElement("h5",null,"Legend")),React.createElement("div",{className:"legend-entry"},React.createElement("div",{className:"circle no-deadline-visit"}),React.createElement("span",null,"No deadline for visit. This is the initial state when a candidate is created.")),React.createElement("div",{className:"legend-entry"},React.createElement("div",{className:"circle deadline-approaching-visit"}),React.createElement("span",null,"Visit registration deadline approaching. Once the Initial Assessment - Screening visit has been registered all other visits must be registered within 90 days.")),React.createElement("div",{className:"legend-entry"},React.createElement("div",{className:"circle deadline-past-visit"}),React.createElement("span",null,"Deadline for visit registration has passed.")),React.createElement("div",{className:"legend-entry"},React.createElement("div",{className:"circle complete-visit deadline-approaching-data-entry"}),React.createElement("span",null,"Visit registration has been completed. Data entry deadline is now approaching and should be completed within 14 days of visit registration.")),React.createElement("div",{className:"legend-entry"},React.createElement("div",{className:"circle complete-visit deadline-past-data-entry"}),React.createElement("span",null,"Deadline for data entry has passed.")),React.createElement("div",{className:"legend-entry"},React.createElement("div",{className:"circle complete-visit complete-data-entry"}),React.createElement("span",null,"Initial data entry has been completed.")),React.createElement("div",{className:"legend-entry"},React.createElement("div",{className:"circle complete-visit complete-data-entry"},React.createElement("span",{className:"inner-circle-text"},"D")),React.createElement("span",null,"Double data entry has been completed.")),React.createElement("div",{className:"legend-entry"},React.createElement("div",{className:"circle complete-visit complete-data-entry-dcc"},React.createElement("span",{className:"glyphicon glyphicon-ok inner-circle-glyph"})),React.createElement("span",null,"Data has been sent to DCC.")),React.createElement("div",{className:"legend-entry"},React.createElement("div",{className:"circle cancelled-visit cancelled-data"},React.createElement("span",{className:"glyphicon glyphicon-remove inner-circle-glyph"})),React.createElement("span",null,"Visit has been cancelled. Participant has been either excluded or withdrawn.")))}}]),Legend}(React.Component),SideBarCandInstContent=function(_React$Component7){function SideBarCandInstContent(){return _classCallCheck(this,SideBarCandInstContent),_possibleConstructorReturn(this,(SideBarCandInstContent.__proto__||Object.getPrototypeOf(SideBarCandInstContent)).apply(this,arguments))}return _inherits(SideBarCandInstContent,_React$Component7),_createClass(SideBarCandInstContent,[{key:"render",value:function(){var content=[],instListURL=loris.BaseURL+"/instrument_list/?candID="+this.props.candid+"&sessionID="+this.props.sessionID;content.push(React.createElement("div",{className:"SideBarHeader"},React.createElement("h5",null,React.createElement("a",{href:instListURL},"Participant ",this.props.pscid))));var data=this.props.data,sessionID=this.props.sessionID,candid=this.props.candid,style={whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",display:"block"};for(var sg in data){content.push(React.createElement("h6",null,sg));for(var t in data[sg]){var inst=data[sg][t],url=loris.BaseURL+"/"+inst.testName+"/?commentID="+inst.commentID+"&sessionID="+sessionID+"&candID="+candid,flagCompletion=void 0;flagCompletion="Complete"===inst.ddeCompletion?React.createElement("span",null,React.createElement("span",{className:"glyphicon glyphicon-ok complete"}),React.createElement("span",{className:"glyphicon glyphicon-ok complete"})):"Complete"===inst.completion?React.createElement("span",{className:"glyphicon glyphicon-ok complete"}):React.createElement("span",{className:"glyphicon glyphicon-alert deadline-past"});var conflicts=[];inst.conflicts&&conflicts.push(React.createElement("a",{className:"left-indent2",href:"#",onClick:openConflictResolver.bind(null,candid,inst.testName)},React.createElement("span",{className:"glyphicon glyphicon-remove-circle"}),"Conflicts")),content.push(React.createElement("div",{className:"SideBarInst"},React.createElement("a",{href:url,style:style},flagCompletion,inst.fullName),conflicts))}}return React.createElement("div",null,content)}}]),SideBarCandInstContent}(React.Component),SideBarCandContent=function(_React$Component8){function SideBarCandContent(){return _classCallCheck(this,SideBarCandContent),_possibleConstructorReturn(this,(SideBarCandContent.__proto__||Object.getPrototypeOf(SideBarCandContent)).apply(this,arguments))}return _inherits(SideBarCandContent,_React$Component8),_createClass(SideBarCandContent,[{key:"render",value:function(){var content=[],visits=this.props.row.visits,pscid=this.props.row.pscid,candid=this.props.row.candid,feedback=this.props.row.feedback,statusDesc=this.props.row.statusDesc,dateReg=formatDate(new Date(this.props.row.dateReg)),iconColor={color:"#444444"},profileURL=loris.BaseURL+"/"+candid,feedbackIcon=[];if(feedback.profile?(feedbackIcon.push(React.createElement("span",{className:"glyphicon glyphicon-edit",style:iconColor})),content.push(React.createElement("div",{className:"SideBarHeader"},React.createElement("h5",null,feedbackIcon,"Â ",React.createElement("a",{href:"#",onClick:function(){return openBVLFeedback(candid)}},"Participant ",pscid))))):content.push(React.createElement("div",{className:"SideBarHeader"},React.createElement("h5",null,React.createElement("a",{href:profileURL},"Participant ",pscid)))),this.props.row.dxReappraisal){var url=loris.BaseURL+("/candidate_parameters/?candID="+candid+"&identifier="+candid+"#diagnosisReappraisal");content.push(React.createElement("a",{href:url,className:"small"},React.createElement("span",{className:"glyphicon glyphicon-random",style:iconColor}),React.createElement("em",null,"Â Participant has had a diagnosis reappraisal")))}content.push(React.createElement("p",{className:"small"},React.createElement("em",null,"Status: ",statusDesc,", registered on ",dateReg)));var visitContent=[];return visits.forEach(function(v){if(v.cohort===this.props.currentCohort||"all"===this.props.currentCohort){var _url=loris.BaseURL+"/",vr=prettyStatus(v.visitRegStatus,v.visitRegDueDate),de=prettyStatus(v.dataEntryStatus,v.dataEntryDueDate),visitLink=[],instrumentFeedback=[];if(feedback.visits&&feedback.visits.hasOwnProperty(v.sessionID)?visitLink.push(React.createElement("a",{href:"#",onClick:function(){return openBVLFeedback(candid,v.sessionID)}},React.createElement("span",{className:"glyphicon glyphicon-edit",style:iconColor}),"Â ",backToFrontVLs.get(v.visitLabel))):(_url+="instrument_list/?candID="+candid+"&sessionID="+v.sessionID,visitLink.push(React.createElement("a",{href:_url},backToFrontVLs.get(v.visitLabel)))),feedback.instruments&&feedback.instruments.hasOwnProperty(v.sessionID)){var instLinkStyle={whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",display:"block",margin:"5px"},_loop=function(f){if(!feedback.instruments[f].commentID)return"continue";var fb=feedback.instruments[f];instrumentFeedback.push(React.createElement("a",{href:"#",className:"sidebar-visit-status",onClick:function(){return openBVLFeedback(candid,v.sessionID,fb.commentID,fb.testName)},style:instLinkStyle},React.createElement("span",{className:"glyphicon glyphicon-edit",style:iconColor})," "+fb.fullName))};for(var f in feedback.instruments){_loop(f)}}"complete"===vr.status&&"complete"===de.status?visitContent.push(React.createElement("div",{className:"sidebar-visit"},visitLink,vr.html,instrumentFeedback)):de.html?visitContent.push(React.createElement("div",{className:"sidebar-visit"},visitLink,React.createElement("p",{className:"sidebar-visit-status"},"Visit Registration ",vr.html),React.createElement("p",{className:"sidebar-visit-status"},"Data Entry ",de.html),instrumentFeedback)):(_url+=candid,visitContent.push(React.createElement("div",{className:"sidebar-visit"},React.createElement("a",{href:_url},backToFrontVLs.get(v.visitLabel),":"),React.createElement("p",{className:"sidebar-visit-status"},"Visit Registration: ",vr.html))))}}.bind(this)),0===visitContent.length&&(visitContent=React.createElement("p",null,"No applicable visits for this participant for cohort ",this.props.currentCohort)),content.push(visitContent),React.createElement("div",{className:"SideBarCandContent"},content)}}]),SideBarCandContent}(React.Component),SideBarVisitContent=function(_React$Component9){function SideBarVisitContent(){return _classCallCheck(this,SideBarVisitContent),_possibleConstructorReturn(this,(SideBarVisitContent.__proto__||Object.getPrototypeOf(SideBarVisitContent)).apply(this,arguments))}return _inherits(SideBarVisitContent,_React$Component9),_createClass(SideBarVisitContent,[{key:"render",value:function(){var visitDeadlines=[],dataDeadlines=[],visitsSortable=[],dataSortable=[],_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=this.props.rows[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var row=_step.value;if(row.psc===this.props.currentSite||"all"===this.props.currentSite){var pscid=row.pscid,candid=row.candid,instListUrl=loris.BaseURL+"/instrument_list/?candID="+candid+"&sessionID=",timepointListURL=loris.BaseURL+"/timepoint_list/?candID="+candid,_iteratorNormalCompletion4=!0,_didIteratorError4=!1,_iteratorError4=void 0;try{for(var _step4,_iterator4=row.visits[Symbol.iterator]();!(_iteratorNormalCompletion4=(_step4=_iterator4.next()).done);_iteratorNormalCompletion4=!0){var v=_step4.value;if(v.visitLabel===this.props.visit){if(v.cohort===this.props.currentCohort||"all"===this.props.currentCohort){instListUrl+=v.sessionID;var vr=prettyStatus(v.visitRegStatus,v.visitRegDueDate);"deadline-past"!==vr.status&&"deadline-approaching"!==vr.status||visitsSortable.push({prettyStatus:vr,URL:timepointListURL,pscid:pscid});var de=prettyStatus(v.dataEntryStatus,v.dataEntryDueDate);"deadline-past"!==de.status&&"deadline-approaching"!==de.status||dataSortable.push({prettyStatus:de,URL:instListUrl,pscid:pscid})}break}}}catch(err){_didIteratorError4=!0,_iteratorError4=err}finally{try{!_iteratorNormalCompletion4&&_iterator4.return&&_iterator4.return()}finally{if(_didIteratorError4)throw _iteratorError4}}}}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{!_iteratorNormalCompletion&&_iterator.return&&_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}visitsSortable=visitsSortable.sort(function(a,b){return a.prettyStatus.daysLeft-b.prettyStatus.daysLeft}),dataSortable=dataSortable.sort(function(a,b){return a.prettyStatus.daysLeft-b.prettyStatus.daysLeft});var _iteratorNormalCompletion2=!0,_didIteratorError2=!1,_iteratorError2=void 0;try{for(var _step2,_iterator2=visitsSortable[Symbol.iterator]();!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=!0){var _vr=_step2.value;visitDeadlines.push(React.createElement("p",null,React.createElement("a",{href:_vr.URL},_vr.pscid),_vr.prettyStatus.html))}}catch(err){_didIteratorError2=!0,_iteratorError2=err}finally{try{!_iteratorNormalCompletion2&&_iterator2.return&&_iterator2.return()}finally{if(_didIteratorError2)throw _iteratorError2}}var _iteratorNormalCompletion3=!0,_didIteratorError3=!1,_iteratorError3=void 0;try{for(var _step3,_iterator3=dataSortable[Symbol.iterator]();!(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done);_iteratorNormalCompletion3=!0){var _de=_step3.value;dataDeadlines.push(React.createElement("p",null,React.createElement("a",{href:_de.URL},_de.pscid),_de.prettyStatus.html))}}catch(err){_didIteratorError3=!0,_iteratorError3=err}finally{try{!_iteratorNormalCompletion3&&_iterator3.return&&_iterator3.return()}finally{if(_didIteratorError3)throw _iteratorError3}}return visitDeadlines.length<=1&&(visitDeadlines=visitDeadlines.concat(React.createElement("p",{className:"complete"},"No upcoming visit deadlines"))),dataDeadlines.length<=1&&(dataDeadlines=dataDeadlines.concat(React.createElement("p",{className:"complete"},"No upcoming data entry deadlines"))),React.createElement("div",{className:"SideBarVisitContent"},React.createElement("div",{className:"SideBarHeader"},React.createElement("h5",null,backToFrontVLs.get(this.props.visit)," Visit")),React.createElement("div",{className:"SideBarSubContent"},React.createElement("h5",{className:"SideBarSubheader"},"Upcoming Visit Deadlines"),visitDeadlines),React.createElement("div",{className:"SideBarSubContent"},React.createElement("h5",{className:"SideBarSubheader"},"Upcoming Data Entry Deadlines"),dataDeadlines))}}]),SideBarVisitContent}(React.Component),SideBar=function(_React$Component10){function SideBar(){return _classCallCheck(this,SideBar),_possibleConstructorReturn(this,(SideBar.__proto__||Object.getPrototypeOf(SideBar)).apply(this,arguments))}return _inherits(SideBar,_React$Component10),_createClass(SideBar,[{key:"render",value:function(){return React.createElement("div",{className:"SideBar"},React.createElement("div",{className:"SideBarContent"},React.createElement("a",{href:"#",className:"closebtn",onClick:this.props.closeSideBar},"Ã"),this.props.sideBarContent))}}]),SideBar}(React.Component),VisitCell=function(_React$Component11){function VisitCell(){return _classCallCheck(this,VisitCell),_possibleConstructorReturn(this,(VisitCell.__proto__||Object.getPrototypeOf(VisitCell)).apply(this,arguments))}return _inherits(VisitCell,_React$Component11),_createClass(VisitCell,[{key:"render",value:function(){var _this12=this,visit=this.props.visit,bgColor={};if(visit.visitLabel===this.props.currentVisit&&(bgColor={backgroundColor:HIGHLIGHT_COLOR}),visit.cohort!==this.props.currentCohort&&"all"!==this.props.currentCohort)return React.createElement("td",{className:"center "+visit.visitLabel,style:bgColor},"N/A");var _ret2=function(){var tooltipContent=[],vr=prettyStatus(visit.visitRegStatus,visit.visitRegDueDate);tooltipContent.push(React.createElement("p",{key:"vr-status"},"Visit Registration: ",vr.html));var innerCircleInfo=null;if(visit.dataEntryStatus){var de=prettyStatus(visit.dataEntryStatus,visit.dataEntryDueDate);tooltipContent.push(React.createElement("p",{key:"de-status"},"Data Entry: ",de.html)),visit.totalInstrs&&tooltipContent.push(React.createElement("p",{key:"instr-entered",className:"center"},React.createElement("i",null,visit.instrCompleted,"/",visit.totalInstrs," instruments entered"))),visit.totalDDEInstrs&&tooltipContent.push(React.createElement("p",{key:"dde"},"Double Data Entry:"),React.createElement("p",{key:"dde-entered",className:"center"},React.createElement("i",null,visit.ddeInstCompleted,"/",visit.totalDDEInstrs," instruments entered"))),visit.numConflicts>0&&tooltipContent.push(React.createElement("p",{key:"conflicts",className:"center"},React.createElement("span",{className:"glyphicon glyphicon-remove-circle"}),"Â ",visit.numConflicts," unresolved conflicts.")),"cancelled-visit"===visit.visitRegStatus?innerCircleInfo=React.createElement("span",{className:"glyphicon glyphicon-remove inner-circle-glyph"}):visit.sentToDCC?(innerCircleInfo=React.createElement("span",{className:"glyphicon glyphicon-ok inner-circle-glyph"}),tooltipContent.push(React.createElement("p",{key:"dcc-sent",className:"complete"},"Data sent to DCC"))):visit.ddeCompleted&&"complete-data-entry"===visit.dataEntryStatus&&(innerCircleInfo=React.createElement("span",{className:"inner-circle-text"},"D"),tooltipContent.push(React.createElement("p",{key:"dcc-not-sent",className:"deadline-approaching"},"Data not yet sent to DCC")))}var visitClass="circle "+visit.dataEntryStatus+" "+visit.visitRegStatus,sidebarArgs={sessionID:visit.sessionID,pscid:_this12.props.pscid,candid:_this12.props.candid};return{v:React.createElement("td",{className:visit.visitLabel,style:bgColor},React.createElement("div",{onClick:function(){return _this12.props.showCandInstFocus(sidebarArgs)},"data-tip":!0,"data-for":visit.sessionID,className:visitClass},innerCircleInfo,React.createElement(ReactTooltip,{id:visit.sessionID,place:"top",type:"dark",effect:"solid"},React.createElement("div",{className:"ReactTooltipContent"},tooltipContent))))}}();return"object"===("undefined"==typeof _ret2?"undefined":_typeof(_ret2))?_ret2.v:void 0}}]),VisitCell}(React.Component),PSCIDCell=function(_React$Component12){function PSCIDCell(){return _classCallCheck(this,PSCIDCell),_possibleConstructorReturn(this,(PSCIDCell.__proto__||Object.getPrototypeOf(PSCIDCell)).apply(this,arguments))}return _inherits(PSCIDCell,_React$Component12),_createClass(PSCIDCell,[{key:"render",value:function(){var feedBackIcons=[],style={color:"#444444"};return Object.keys(this.props.feedback).length&&feedBackIcons.push(React.createElement("span",{className:"glyphicon glyphicon-edit",style:style}),React.createElement("span",null,"Â ")),this.props.dxReappraisal&&feedBackIcons.push(React.createElement("span",{className:"glyphicon glyphicon-random",style:style})),React.createElement("td",{className:"PSCIDCell",onClick:this.props.clickHandler},this.props.pscid,"Â ",feedBackIcons)}}]),PSCIDCell}(React.Component),StudyTrackerRow=function(_React$Component13){function StudyTrackerRow(props){_classCallCheck(this,StudyTrackerRow);var _this14=_possibleConstructorReturn(this,(StudyTrackerRow.__proto__||Object.getPrototypeOf(StudyTrackerRow)).call(this,props));return _this14.highlightRow=_this14.highlightRow.bind(_this14),_this14.unhighlightRow=_this14.unhighlightRow.bind(_this14),_this14.keepHighlightedShowCandFocus=_this14.keepHighlightedShowCandFocus.bind(_this14),_this14}return _inherits(StudyTrackerRow,_React$Component13),_createClass(StudyTrackerRow,[{key:"highlightRow",value:function(){$("#"+this.props.pscid).css("background-color",HIGHLIGHT_COLOR)}},{key:"unhighlightRow",value:function(){this.props.currentPSCID!==this.props.pscid&&$("#"+this.props.pscid).css("background-color","")}},{key:"keepHighlightedShowCandFocus",value:function(event){$(".StudyTrackerRow").css("background-color",""),this.props.visits.forEach(function(v){$("."+v.visitLabel).css("background-color","")}),this.highlightRow(),~event.target.className.indexOf("data-entry")||this.props.showCandFocus(event)}},{key:"render",value:function(){var style={},visits=this.props.visits.map(function(v,index){return React.createElement(VisitCell,{key:index,visit:v,pscid:this.props.pscid,candid:this.props.candid,currentCohort:this.props.currentCohort,currentVisit:this.props.currentVisit,showCandInstFocus:this.props.showCandInstFocus})}.bind(this));return this.props.pscid===this.props.currentPSCID&&(style={backgroundColor:HIGHLIGHT_COLOR}),React.createElement("tr",{className:"StudyTrackerRow",id:this.props.pscid,onClick:this.keepHighlightedShowCandFocus,onMouseEnter:this.highlightRow,onMouseLeave:this.unhighlightRow,style:style},React.createElement(PSCIDCell,{pscid:this.props.pscid,feedback:this.props.feedback,dxReappraisal:this.props.dxReappraisal,clickHandler:this.keepHighlightedShowCandFocus}),visits)}}]),StudyTrackerRow}(React.Component),StudyTrackerHeader=function(_React$Component14){function StudyTrackerHeader(props){_classCallCheck(this,StudyTrackerHeader);var _this15=_possibleConstructorReturn(this,(StudyTrackerHeader.__proto__||Object.getPrototypeOf(StudyTrackerHeader)).call(this,props));return _this15.state={visitInFocus:null},_this15.highlightColumns=_this15.highlightColumns.bind(_this15),_this15.unhighlightColumns=_this15.unhighlightColumns.bind(_this15),_this15.switchOrder=_this15.switchOrder.bind(_this15),_this15.keepHighlightedShowVisitFocus=_this15.keepHighlightedShowVisitFocus.bind(_this15),_this15}return _inherits(StudyTrackerHeader,_React$Component14),_createClass(StudyTrackerHeader,[{key:"highlightColumns",value:function(event){var beVL=frontToBackVLs.get($(event.target).text()),visitClass="."+beVL;$(visitClass).css("background-color",HIGHLIGHT_COLOR)}},{key:"unhighlightColumns",value:function(event){var beVL=frontToBackVLs.get($(event.target).text());if(this.props.currentVisit!==beVL){var visitClass="."+beVL;$(visitClass).css("background-color","")}}},{key:"keepHighlightedShowVisitFocus",value:function(event){$(".StudyTrackerRow").css("background-color",""),this.props.visitLabels.forEach(function(vl){$("."+vl).css("background-color","")}),this.highlightColumns(event),this.props.showVisitFocus(event)}},{key:"switchOrder",value:function(){document.getElementById("order-toggle").classList.contains("glyphicon-chevron-down")?(document.getElementById("order-toggle").classList.remove("glyphicon-chevron-down"),document.getElementById("order-toggle").classList.add("glyphicon-chevron-up")):(document.getElementById("order-toggle").classList.remove("glyphicon-chevron-up"),document.getElementById("order-toggle").classList.add("glyphicon-chevron-down")),this.props.switchOrder()}},{key:"render",value:function(){var colWidth=91.6666/this.props.visitLabels.length,colStyle={width:colWidth+"%"},visitLabelHeaders=this.props.visitLabels.map(function(vl){var cssClass="VLHeader "+vl;return React.createElement("th",{style:colStyle,onMouseEnter:this.highlightColumns,onMouseLeave:this.unhighlightColumns,onClick:this.keepHighlightedShowVisitFocus,key:vl,className:cssClass},backToFrontVLs.get(vl))}.bind(this));return React.createElement("thead",{className:"StudyTrackerHeader"},React.createElement("tr",null,React.createElement("th",{id:"order-toggle",className:"col-md-1 center glyphicon glyphicon-chevron-down",style:{color:"#444444"},onClick:this.switchOrder}),visitLabelHeaders))}}]),StudyTrackerHeader}(React.Component),StudyTracker=function(_React$Component15){function StudyTracker(props){_classCallCheck(this,StudyTracker);var _this16=_possibleConstructorReturn(this,(StudyTracker.__proto__||Object.getPrototypeOf(StudyTracker)).call(this,props));return _this16.state={rows:[],visitLabels:[],feVisitLabels:[],currentSite:"all",sites:Object.create(null),teams:[],currentTeam:"COMPASS-ND",currentCohort:"all",cohorts:Object.create(null),sideBarContent:null,currentPSCID:null,currentVisit:null,currentSideBarFocus:null,filterCandText:"",filtersOpen:!0,active:_this16.props.active,isLoading:!0},_this16.showCandInstFocus=_this16.showCandInstFocus.bind(_this16),_this16.showCandFocus=_this16.showCandFocus.bind(_this16),_this16.showVisitFocus=_this16.showVisitFocus.bind(_this16),_this16.showLegend=_this16.showLegend.bind(_this16),_this16.showSideBar=_this16.showSideBar.bind(_this16),_this16.closeSideBar=_this16.closeSideBar.bind(_this16),_this16.showFilters=_this16.showFilters.bind(_this16),_this16.filterCand=_this16.filterCand.bind(_this16),_this16.filterSites=_this16.filterSites.bind(_this16),_this16.filterCohorts=_this16.filterCohorts.bind(_this16),_this16.switchOrder=_this16.switchOrder.bind(_this16),_this16.renderRow=_this16.renderRow.bind(_this16),_this16.rowHasCurrentCohortVisit=_this16.rowHasCurrentCohortVisit.bind(_this16),
_this16}return _inherits(StudyTracker,_React$Component15),_createClass(StudyTracker,[{key:"loadDataFromServer",value:function(){$.get(GET_DATA_URL,{data:"all"},function(data,status){if(console.log(data),"success"===status){var cohorts=Object.create(null),visitLabels=[],feVisitLabels=[],rows=[],sites=Object.create(null);for(var r in data.tableData)rows.push(data.tableData[r]);this.setState({rows:rows});for(var c in data.cohorts)cohorts[c]=data.cohorts[c];this.setState({cohorts:cohorts});for(var s in data.sites)sites[s]=data.sites[s];this.setState({sites:sites});for(var i=0;i<data.visitLabels.length;i++)visitLabels.push(data.visitLabels[i]),feVisitLabels.push(data.feVisitLabels[i]),backToFrontVLs.set(data.visitLabels[i],data.feVisitLabels[i]),frontToBackVLs.set(data.feVisitLabels[i],data.visitLabels[i]);this.setState({visitLabels:visitLabels,feVisitLabels:feVisitLabels,isLoading:!1})}}.bind(this))}},{key:"componentDidMount",value:function(){this.loadDataFromServer()}},{key:"showCandInstFocus",value:function(sidebarArgs){this.setState({currentPSCID:sidebarArgs.pscid,currentVisit:null,currentSideBarFocus:"candidate_instruments"}),sidebarArgs.sessionID>0&&$.get(GET_DATA_URL,{data:"instruments",sessionID:sidebarArgs.sessionID},function(data,status){if("success"===status){var sideBarContent=React.createElement(SideBarCandInstContent,{sessionID:sidebarArgs.sessionID,pscid:sidebarArgs.pscid,candid:sidebarArgs.candid,data:data});this.setState({sideBarContent:sideBarContent}),this.showSideBar()}}.bind(this))}},{key:"showCandFocus",value:function(event){var pscid=void 0;event?(pscid=$(event.target).closest(".StudyTrackerRow").attr("id"),this.setState({currentPSCID:pscid,currentVisit:null,currentSideBarFocus:"candidate"})):pscid=this.state.currentPSCID;var row=void 0,_iteratorNormalCompletion5=!0,_didIteratorError5=!1,_iteratorError5=void 0;try{for(var _step5,_iterator5=this.state.rows[Symbol.iterator]();!(_iteratorNormalCompletion5=(_step5=_iterator5.next()).done);_iteratorNormalCompletion5=!0){var r=_step5.value;r.pscid===pscid&&(row=r)}}catch(err){_didIteratorError5=!0,_iteratorError5=err}finally{try{!_iteratorNormalCompletion5&&_iterator5.return&&_iterator5.return()}finally{if(_didIteratorError5)throw _iteratorError5}}var sideBarContent=React.createElement(SideBarCandContent,{currentCohort:this.state.currentCohort,row:row});this.setState({sideBarContent:sideBarContent}),event&&this.showSideBar()}},{key:"showVisitFocus",value:function(event){var visit=void 0;event?(visit=frontToBackVLs.get($(event.target).text()),this.setState({currentVisit:visit,currentPSCID:null,currentSideBarFocus:"visit"})):visit=this.state.currentVisit;var sideBarContent=React.createElement(SideBarVisitContent,{visit:visit,currentSite:this.state.currentSite,currentCohort:this.state.currentCohort,rows:this.state.rows});this.setState({sideBarContent:sideBarContent}),event&&this.showSideBar()}},{key:"showLegend",value:function(event){var sideBarContent=React.createElement(Legend,null);this.setState({currentVisit:null,currentPSCID:null,currentSideBarFocus:"legend",sideBarContent:sideBarContent}),event&&this.showSideBar()}},{key:"showSideBar",value:function(){$(".SideBar").css("width",SIDEBAR_WIDTH);var selectors=".study-tracker-table, .study-tracker-header, .filter-container";$(selectors).css("width",COMPRESS_TBL_WIDTH)}},{key:"closeSideBar",value:function(){$(".SideBar").css("width","0px");var selectors=".study-tracker-table, .study-tracker-header, .filter-container";$(selectors).css("width","100%"),this.setState({sideBarContent:null,currentPSCID:null,currentVisit:null,currentSideBarFocus:null}),$(".VLHeader").css("background-color","")}},{key:"showFilters",value:function(){$(".filter-container").toggle("slow");var filtersOpen=!this.state.filtersOpen;this.setState({filtersOpen:filtersOpen})}},{key:"filterCohorts",value:function(event){var callback=function(){};"visit"===this.state.currentSideBarFocus?callback=this.showVisitFocus:"candidate"===this.state.currentSideBarFocus?callback=this.showCandFocus:"candidate_instruments"===this.state.currentSideBarFocus&&(callback=this.showCandInstFocus),this.setState({currentCohort:event.target.value},callback)}},{key:"filterSites",value:function(event){var callback=function(){};"visit"===this.state.currentSideBarFocus?callback=this.showVisitFocus:"candidate"===this.state.currentSideBarFocus?callback=this.showCandFocus:"candidate_instruments"===this.state.currentSideBarFocus&&(callback=this.showCandInstFocus),this.setState({currentSite:event.target.value},callback)}},{key:"filterCand",value:function(filterCandText){this.setState({filterCandText:filterCandText})}},{key:"switchOrder",value:function(){var rows=this.state.rows.reverse();this.setState({rows:rows})}},{key:"rowHasCurrentCohortVisit",value:function(row){if("all"===this.state.currentCohort)return!0;var result=!1;return row.visits.forEach(function(v){v.cohort===this.state.currentCohort&&(result=!0)}.bind(this)),result}},{key:"renderRow",value:function(row){return!(!this.rowHasCurrentCohortVisit(row)||row.psc!==this.state.currentSite&&"all"!==this.state.currentSite||!row.pscid.startsWith(this.state.filterCandText.toUpperCase()))}},{key:"render",value:function(){var dataRows=[];if(this.state.rows.forEach(function(row){this.renderRow(row)&&dataRows.push(React.createElement(StudyTrackerRow,{key:row.pscid,pscid:row.pscid,candid:row.candid,visits:row.visits,dateReg:row.dateReg,feedback:row.feedback,dxReappraisal:row.dxReappraisal,currentCohort:this.state.currentCohort,currentVisit:this.state.currentVisit,currentPSCID:this.state.currentPSCID,showCandFocus:this.showCandFocus,showCandInstFocus:this.showCandInstFocus}))}.bind(this)),0===dataRows.length)var noMatch=React.createElement("p",null,"No participants match the current search parameters.");return this.state.isLoading?React.createElement("div",{className:"center"},React.createElement("img",{src:loris.BaseURL+"/images/LORIS_logo.svg",height:"300px",width:"400px",className:"center"}),React.createElement("h3",null,"Loading...")):React.createElement("div",{className:"StudyTracker"},React.createElement("div",{className:"row study-tracker-header"},React.createElement("div",{className:"col-md-6"},React.createElement("h3",{className:"dashboard-header"},"Study Progression")),React.createElement("div",{className:"col-md-6"},React.createElement("h3",{className:"dashboard-header"},React.createElement("span",{className:"right-align legend-icon",onClick:this.showLegend},"?")))),React.createElement("div",{className:"row study-tracker-header"},React.createElement("div",{className:"col-md-6"},React.createElement("h5",null,"Total Rows: ",dataRows.length)),React.createElement("div",{className:"col-md-6"},React.createElement(FilterDisplayToggle,{filtersOpen:this.state.filtersOpen,showFilters:this.showFilters}))),React.createElement("div",{className:"row filter-container"},React.createElement(Filters,{filterCand:this.filterCand,sites:this.state.sites,filterSites:this.filterSites,teams:this.state.teams,filterTeams:this.filterTeams,cohorts:this.state.cohorts,filterCohorts:this.filterCohorts})),React.createElement("div",null,React.createElement("table",{className:"table study-tracker-table"},React.createElement(StudyTrackerHeader,{visitLabels:this.state.visitLabels,currentVisit:this.state.currentVisit,showVisitFocus:this.showVisitFocus,switchOrder:this.switchOrder}),React.createElement("tbody",null,dataRows)),noMatch,React.createElement(SideBar,{closeSideBar:this.closeSideBar,sideBarContent:this.state.sideBarContent,currentCohort:this.state.currentCohort})))}}]),StudyTracker}(React.Component);exports.default=StudyTracker}});
//# sourceMappingURL=index.js.map